今天我给大家分享宏病毒组的内容，分为两大部分给大家介绍，首先先认识宏病毒组的概念和应用，然后再熟悉一下宏病毒组的分析流程。

宏病毒组，其实还是宏基因组，前面师兄师姐已经给大家讲了宏基因组的分析流程和研究实例，那宏病毒组就是把宏基因组中那部分病毒序列拿出来单独进行分析。病毒在生态环境中的数量可能要多于细菌，但是病毒的基因组特别小，所以在宏基因组样本中的病毒序列含量就比较低，这给宏病毒组的研究造成了一定的困难，但是近些年出现一些样本预处理措施能够富集病毒序列，同时加上生物信息分析技术的发展，逐渐降低了宏病毒组研究的难度，由此也出现了比较多的宏病毒高分文章。
对于宏病毒组的应用，首先就是与人直接相关的应用，比如研究疾病状态中人体中病毒组的变化。大家对人体的细菌已经很熟悉了，尤其是肠道菌群，也大概知道肠道菌群的变化可能会导致某种疾病状态。但是对人体中的病毒组可能相对了解比较少，起始人体中的病毒数量与细菌数量大致相当，每个人体大约包括10的13次方个病毒颗粒，也就是十万亿个，在肠道、口腔、肺甚至脑脊液中都有病毒存在。所以宏病毒组的第一个研究对象可以是人体。
其次，环境中也存在大量病毒颗粒，通过监测生活污水中病毒种群的动态变化，可以预测流感、猴痘等病毒性疾病的暴发。
另外，也可以对动物或者昆虫媒介体内的病毒组进行研究，来评估动物病毒向人类传播的风险。
比如这些文献，这篇是今年2月分发的，作者单位是山东大学公共卫生学院，题目是长角血蜱的基因遗传进化和生态特点塑造的病毒组多样性。实验部分就是在山东省内采集了一些长角血蜱，然后进行测序，除了病毒组外，他还测了长角血蜱的线粒体来分析长角血蜱的进化特点。然后就是数据分析部分，这部分分析了长角血蜱中病毒组的物种多样性，结合长角血蜱的进化多样性，比较了进化树中不同簇的长角血蜱中病毒组的多样性，后面又结合了一些生态的数据，比如降水量、湿度等进行了建模。
然后下面这篇也是类似的，题目是生态气候驱动因素塑造了全球入侵蜱虫物种的病毒组多样性，虽然他题目里说的是入侵性蜱虫，其实他采的样也是长角血蜱，因为文章里说长角血蜱有逐渐向各个国家扩散的趋势，所以叫他入侵性蜱虫。也是二四年发表的。
这一篇是研究蚊子中宏病毒组的。
以上这三篇是我找的昆虫媒介方面的宏病毒组研究。
下面这两篇是动物中的宏病毒组研究。这一篇是猪肠道噬菌体组和噬菌体传播的抗菌素耐药基因的特征，他的研究方法和我们把细菌群落与耐药基因结合起来分析是一样的，这一篇比较了不同猪种、不同年龄的猪肠道里病毒组与耐药基因的差异，是今年6月份发表的。
下面这一篇研究对象是丹顶鹤，它们发现几只腹泻死掉的丹顶鹤，然后做了宏病毒组，分析它腹泻是不是因为感染了某种病毒。
最后是两篇关于人体宏病毒组的研究，也都是今年新发表的。因为今天主要讲宏病毒的方法，所以对这几篇文献就是简单看一下，了解一下宏病毒组的具体应用。
下面就讲一下宏病毒的研究方法。
样品处理上，它和普通的宏病毒组不同之处就在于多了一个富集的步骤，就是这一部分，之后就是鸟枪法把序列打成小片段，接着构建测序文库，上机测序，下机分析。下机分析的话这里有个流程图，是和宏基因组的分析流程相似，包括质量控制、去除污染序列、组装、物种注释、丰度定量这些。如果我们做的话，肯定只需要分析就好了，但是对于上机测序前的处理和上机测序的原理也有必要了解一下。
所以，我们先看一下宏基因组的测序数据是怎么产生的，也就是二代测序的原理。二代测序有两个特点，一是高通量，二是短读长，高通量的意思是说它能同时测好多好多序列，就是速度快。短读长的意思是说他不能测很长的DNA片段，比如他不能一下子把一个细菌的基因组从头到尾连续的测出来。所以在进行测序前，要把DNA片段打碎，打成一小段一小段，比如这一段，假设我们要测这一段的DNA片段的序列，它已经被截成了合适的长度，下一步就是加上接头，这里它两端加的接头序列是不同的，目的是区分正反链，加接头的作用主要是为了后面测序时把这段序列固定到芯片上。加完接头后，构建文库的过程就算完成了。接着就是上机测序。这里是测序仪的一个示意图，可以看到，它有很多孔道，每个孔道里又有很多小凹槽，这就是他说的高通量，每个凹槽同时进行测序。凹槽里固定着与添加到待测DNA上相同的接头，待测DNA片段先解开双链，然后结合到凹槽的接头上，一条正链，一条反链，然后进行桥式扩增，在桥式扩增这一步，还没有正式开始测序，桥式扩增的作用是增加待测DNA链的数量，来提高后面测序时的荧光强度。桥式扩增结束后，会洗去反链，因为他一次只能测一个方向的链，所以要保证结合在凹槽接头上的都是同一方向的链，这里结合的全是正向链。接着就正式开始测序了，测序也是一个扩增的过程，不过测序过程的ATGC四种碱基比较特殊，它们上面多了两个东西，一个是荧光标记，一个是终止基团，四种碱基分别被添加了四种不同颜色的荧光标记。加入这个DNA片段第一个位点是C碱基，那么带有黄色荧光标记的C碱基就会同时结合在凹槽中所有的DNA片段上，并且终止基团阻止下一个碱基结合上来，这个时候传感器就会识别到黄色荧光信号，然后记录下这条DNA序列的第一个位点是C。接着已经结合到DNA序列上的荧光标记和终止基团被洗脱，进行下一个位点的结合。这样进行下去，就会得到这条DNA的序列信息。刚说二代测序有两个特点，高通量和短读长，短读长的原因是当序列过长时，后面结合上去的荧光信号就会紊乱，读取到的碱基信息就会失真，比如第一个碱基位置是C，它就结合上去的全是黄色荧光的C，但是到第一千个碱基时，它可能在那个位点上是A，但是结合上去的确实各种不同的碱基，这就限制了二代测序的读长。
这个就是下机的原始数据，通常以fastq格式储存，每一个@开头的一段就是一次读取的信息，叫做一个read，r，e，a，d，中文翻译好像就叫一个读长，一个样本的一端测序数据存储在一个fastq文件里，如果是双端测序，一个样本就会有两个fastq文件。fastq格式第一行，存储的一般是测序仪器的一些信息，但是我这个数据是从网上下载的，可能原来的测序仪信息被替换掉了，第二行是序列信息，第三行是分隔行，第四行是碱基质量信息。和第二行的碱基信息对应，每一个质量值对应一个碱基，这个质量值是通过刚刚测序时的荧光强度获得的。
现在我们获得了一个样本的双端测序数据，接下来就进入到数据处理的环节。
首先是数据质控，方法师兄师姐已经讲过，我就不再重复，这里用到的一个软件是fastp，作用是去除接头，过滤低质量碱基。输入文件是我们的双端测序数据，也就是两个fastp文件。输出的主要也是两个干净的fastp文件，另外还输出了一个网页格式的报告。可以看一下。上面统计了连个文件里reads的平均长度，可以看到过滤前是250bp，过滤后是245bp。还有总读数，reads的质量这些信息。这是它给出的一个接头识别情况，接头的识别你可以输入接头的信息，也可以不输入，因为这个软件会统计序列开头或者结尾出现的碱基排列的情况，自动识别出接头的序列。这里有一行信息，说输入文件里有接头的序列占比很低，可能之前已经去除过接头了。这个是插入序列的长度统计，这个是不同位置碱基质量的统计，可以看到随着测序长度的增加，碱基质量在逐渐下降，一般碱基质量大于30就认为是可信的数据。这里有个凹陷不知道是什么原因。这个是不同位置的ATGC的占比情况。这是这个原始测序数据的质控报告，没有发现太大的异常。
下一步是质控质量评估，用到一个软件叫seqkit，它有很多序列处理的功能，这里用到的是统计序列数量和长度信息的功能。可以看到给出了四个文件中各自的序列数量和平均长度这些信息。
这里给大家介绍一下这个软件的一个通过引物检索扩增子的功能，和宏病毒组没有太大的关系，讲这个主要是之前全在通过立克次体的引物从立克次体全基因组里模拟这种PCR扩增，她是在NCBI网站上操作的，虽然也可以，但是那个一次只能扩一个引物。用这个软件的话，可能速度更快一点。假设这个测试文件中有三条序列，我们想用特定的一对引物从中扩增出目标序列，就需要输入seqkit amplicon -F TTC -R CGC test_seq.fa，回车，它就会返回完成扩增的序列，如果有多条序列的话，就需要把序列以表格形式输入，它就会返回这多条序列的扩增结果。如果有多个基因组的话，就可以用一个循环功能实现。这是对seqkit通过引物检索扩增子功能的一个额外介绍。

下面还是回到宏病毒组的流程，完成数据质控之后，就可以进行序列组装了，之前说因为二代测序读长短，所以我们在测序之前把DNA全部打成小的片段，所以这里就是要把之前打断的片段组装回去，这里不需要比对数据库也不需要知道序列的物种，它组装的原理简单来说就是根据各个序列之间的重叠部分确定它们的前后位置。这里用到的软件是megahit，输入经过质控的双端序列的两个文件，默认参数运行就可以了。这是它在真实数据上的运行情况，这个数据是从NCBI下载的，我挑了一个比较小的文件，双端测序文件一共也有6个g，这个组装步骤一共花了接近两个小时，是比较耗时的一个操作。
这个是他组装完成后的文件，一共215mb，可以看一下，后面的注释过程要用到的就是这个fasta格式的文件了，它一段序列包括两个部分，以>开头，后接序列的描述信息，下一行就是序列本身。
